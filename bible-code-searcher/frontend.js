const main=document.querySelector("main"),form=document.getElementById("search-form"),searchBtn=document.getElementById("search-btn"),searchInput=document.getElementById("search-input"),minStepInput=document.getElementById("min-step-input"),maxStepInput=document.getElementById("max-step-input"),resultTemplate=document.getElementById("result-template"),searchIndicator=document.getElementById("search-indicator");function inputLength(){return searchInput.value.match(/[א-ת]/g)?.length||0}function onInput(){searchInput.value=searchInput.value.trimStart(),searchBtn.disabled=!inputLength(),""!==maxStepInput.value?(maxStepInput.value=Math.min(maxPossibleStep(),+maxStepInput.value),""!==minStepInput.value&&(minStepInput.value=Math.min(+minStepInput.value,+maxStepInput.value))):""!==minStepInput.value&&(minStepInput.value=Math.min(maxPossibleStep(),+minStepInput.value))}searchInput.addEventListener("input",onInput),onInput();let workingOnIt=!1;function maxPossibleStep(){const e=inputLength();return 0===e?Number.POSITIVE_INFINITY:Math.floor(304804/(e-1))}function addResult([e,t,n],a){const u=resultTemplate.content.cloneNode(!0),r=u.querySelector(".title"),p=u.querySelector(".info"),i=u.querySelector(".text");r.innerText=`${e}`,t||n?(t&&(p.innerText=`מדילוג ${t} `),n&&(p.innerText+=`עד דילוג ${n}`)):p.innerText="דילוג לא מוגבל",a?(i.innerText=`נמצא בדילוג ${a.step} במקום ${a.index}`,i.classList.add("green")):(i.innerText="לא נמצא",i.classList.add("red")),main.insertBefore(u,document.querySelector(".result"))}form.addEventListener("submit",(async e=>{if(e.preventDefault(),workingOnIt||0===inputLength())return;if(!globalThis.isEngineReady?.())return openModal();searchBtn.style.display="none",searchIndicator.style.display="unset",workingOnIt=!0,searchInput.value=searchInput.value.replace(/[^א-ת\s]/g,"").replace(/\s+/g," ").trim();const t=[searchInput.value,minStepInput.value,maxStepInput.value],n=await search(searchInput.value,{min_step:+minStepInput.value,max_step:+maxStepInput.value});searchBtn.style.display="unset",searchIndicator.style.display="none",workingOnIt=!1,addResult(t,n)}));